---
import type { GetStaticPaths, InferGetStaticParamsType } from "astro";
import Layout from "@layouts/Layout.astro";
import { fetchBooks, fetchBook } from "@data/api";
import type { Book } from "@data/api";

export const getStaticPaths = (async () => {
  const books = await fetchBooks();
  return (
    books?.map((book: Book) => ({
      params: { slug: book.slug },
    })) ?? []
  );
}) satisfies GetStaticPaths;

type Params = InferGetStaticParamsType<typeof getStaticPaths>;
const { slug } = Astro.params as Params;

const book = await fetchBook(slug);
---

<Layout title="Digital Library">
  <main>
    <h1>{book?.title}</h1>
  </main>
</Layout>
